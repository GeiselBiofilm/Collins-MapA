import sys

def main(Infile, Outdir):
	"""
	Creates paired FASTA files that can be processed by the run_muscle_on_dir.py script. Takes table containing all LapA-like proteins identified
	in Identify_LapA-like_proteins.R and converts the sequence to FASTA format with the species name as header. Each LapA-like protein is paired with 
	the protein sequence of LapA for the first file and then MapA for the second file such that you have two output files for each protein in the 
	input file of the format:

	>Species_X.protein_number
	MTGVLLVGT...
	>LapA
	MTPGESSMS...

	Infile: "All_lapg_targets.csv" file produced by Identify_LapA-like_proteins.R
	Outdir: Directory into which all paired FASTA files should by output.

	Example usage: python3 create_paired_fastas.py Data/All_lapg_targets.csv Paired_FASTAs
	"""

	LapA = 'MTPGESSMSSVVAIVKSIVGQVFVVSPEGVRRVLVEGDRLFAGDQVDTGVSGAVSLELADGRTIDLGRDTQWSADTPDSSTDLAEATAQAAPSVEELQQAIAAGVDPTTALESTAAGPSAAGTGGAAGGGHSFVMLDATAGRVDPTIGFPTAGINAAGQAAQNITGGQNTDTTANALRESTLSLSATPSITEAGGVLVYTATLTQAPLTDLTITLSNGAVIVIPAGSTTGTANVPLAPNDTVYNDPTQIDVTVTGTTGGSGITVTPPTTPATTQVTDTIDTTTVTLTAGPSVTEGGQITYTATLTNPAQTPVTVTLSNGSTITIGAGQTTGTVNVPTAPNDVYNNGSTVTTTITGATGGNFENLVPNPTPAVTTITDSIDTTGLTLTATGTVVEGGQITYTATLTNPAQTPVTVTLSNGSTITIGAGQTTGSVNVPTAPNDVYNNGGTVSTTITGATGGNFENLVPNTTPATTTVTDSIDTTNLSLSATGSVAEGGSIVYTATLTNPAGTPVTVTLSNGSVITIEAGKTTGTVTVPAPADDVYKDAGKIEVTIKDATGGNFENLVPSTVPAVTEVTDTIDTSTVKLTADSSVAEGGTVTYTATVGAPVTGSPVTVTLANGQTITIEVGKTTGTVTTTAPNDALAGNAPLTNSITGVSGGNYENLVADKTPVSTTVTDVADITNLTLSATGTVAEGGSIVYTATLTNPAGTPVTVTLSNGSVITIEAGKTTGTVTVPAPADDVYKDAGKVEVTIKDASGGNFENLVPSTVPAVTEVTDTIDTSTVKLSADTSVAEGGTVTYTATVGAPVTGSPVTVTLANGQTITIEVGKTTGTITTTAPNDVLTGHAPLTNSITGVSGGNYENLVADKTPVSTTVTDVADTTNLTLSATGTVAEGGSIVYTATLTNAAGTPVTVTLSNGAVITIEAGKTTGTVTVPAPADDVYKDAGKVEVTIKDATGGNFENLVPSTVPAVTNVTDTIDTTTVKLTATESAVEGGTVTYTATVGAPVTGSPVTVTLANGQSITIEVGKTTGTITTTAPNDALNGHTPLTNAITGVSGGNYENLVADKTPVSTTVTDTVDTTNLTLSASDSVAEGGSIVYTATLTNPAGTSVTVTLSNGAVITIEAGKTTGTVTVPAPADDVYKDAGKVEVTIKDASGGNFENLVPSTVPAVTEVTDTIDTTTVKLTATESAAEGGTVTYTATVGAPVTGSPVTVTLANGQSITIEVGKTTGTVTTTAPNDALNGHTPLTNAITGVSGGNYENLVADKTPVSTRVTDTVDTTNLTLSATGTVAEGGSIVYTATLTNPAGTPVTVTLSNGSVITIEAGKTTGTVTVPAPADDVYKDAGKVEVTIKDATGGNFENLVPSTVPAVTNVTDTIDTSTVKLSADTSVAEGGTVTYTATVGAPVTGSPVTVTLANGQTITIEVGKTTGTITTTAPNDALNGHTPLSNSITGVTGGNYENLVADKTPVSTTVTDTVDTTDLTLTATDSVAEGGSITYTATLTNAAGTPVTVTLSNGAVITIEAGKTTGTVTVDAPKDDVYKDAGKVEVTIKDATGGNFENLVPSTVPAVTEVTDTIDTTTVKLTATESAAEGGTVTYTATVGAPVTGSPVTVTLANGQSITIEVGKTTGTITTTAPNDALNGHTPLTNAITGVSGGNYENLVADKTPVSTTVTDTVDTTNLTLSASDSVAEGGSIVYTATLTNPAGTPVTVTLSNGAVITIEAGKTTGTVTVDAPKDDVYKDAGKVEATISTATGGNFENLVPSTVPAVTEVTDTIDTTTVKLTATESAVEGGTVSYTATVGAPVTGSPVTVTLANGQSITIEVGKTTGTVTTTAPNDVLNGHAPLTNAITNVTGGNYENLVADKTPVSTTVTDTVDTTNLTLSATDSVAEGGSIVYTATLTNPAGTPVTVTLSNGAVITIEAGKTTGTVTVDAPKDDVYKDAGKVEVTIKDATGGNFENLVPSTAPAVTEVTDTIDTSTVKLTATESAAEGGTVTYTATVGAPVTGSPVTVTLANGQSITIEVGKTTGTVTTTAPNDALNGHTPLTNSITDVSGGNYENLVADKTPVSTTVTDTVDTTNLTLSATPEVNEGGQITYTATLTNAAGTPVTVTLSNGAVITIEAGKTTGTVTVDAPKDDVYKDAGKVETTISTTTGGNFENLVTSTAPAVTTVNDTIDTSTVSLTATANVAEGETVVYTATVTAPVTGSPVVVTLSNGQTITIAVGETTGTVNFVAPNSPLAGGSSLSVTIDKATGGNYENLAVDGKSADTSVSDTVDTTNLNLTATDSVAEGGSITYTATLTNPAGTPVTVTLSNGAVITIEAGKTTGTVTVDAPKDDVYKDAGKVEATISTATGGGFENLVPSTVPAVTNVTDTIDTTTVKLTATESAAEGGTVTYTATVGAPVTGSPVTVTLANGQSITIEVGKTTGTVTTTAPNDALNGHTPLTNSITGVSGGNYENLVADKTPVSTTVTDTVDTTNLTLSATGSVAEGGSIVYTATLTNPAGTPVTVTLSNGAVITIEAGKTIGTVTVPAPADDVYKDAGKVEVTIKDATGGNFENLVPSTVPAVTEVTDTIDTTTVKLTASETAAEGGTVTYTATVGAPVTGSPVTVTLANGQQITIEVGKTTGTVTTTAPNDVLNDHAPLTNAITDVSGGNYENLVADKTPVSTTITDTIDTTNLSLTATGTVAEGGSIVYTATLTNPAGTPVTVTLSNGSVITIEAGKTTGTVTVPAPADDVYKDAGTVEATIKSATGGNFENLVTSTTPAVTNVTDTIDTTTVKLTATESAAEGGTVTYTATVGAPVTGSPVTVTLSNGQSITIEVGKTTGTVTTTAPNDALTGHAPLTNAITGVTGGNYENLVADKTPVSTTVTDTVDTTNLTLSATNSVAEGGSIIYTATLTNAAGSPVTVTLSNGAVITIEAGKTTGTVTVPAPADDVYKDAGNVQATITNATGGNFENLVPSTVPAVTQVTDTIDTTTVKLTATESAAEGGTVTYTATVGAPVTGSPVTVNLSNGQSITIEVGKTTGTVTTTAPNDVLNGHAPLTNAITGVTGGNYENLVADKTPVSTTVTDTVDTTNLSLSATGTVAEGGSITYTATLTNAAGTPVTVTLSNGAVIIIEAGKTTGTVTVAAPADDVYKDAGNVQATITNATGGNFENLVTSTTPAVTSVTDTIDTTTVKLTATATAAEGGTVTYTATVGAPVTGSPVTVNLSNGQSITIEVGKTTGTVTTTAPNDVLTGHAPLTNAITGVSGGNYENLVADKTPVSTTVTDTVDTTNLSLSATGTVAEGGSITYTATLTNAAGSPVTVTLSNGAVITIEAGKTTGTVTVPAPADDVYKDAGNVQATITNATGGNFENLVTSTTPAVTSVTDTIDTTTVKLTATATAAEGGNVVYTATVGAPVTGSPVTVTLSNGQSITIEVGKTSGTVTTTAPNDVLNGHAPLTNAITGVSGGNYENLVADKTPVSTTVTDTVDTTNLSLSATNSVAEGGSITYTATLTNAAGTPVTVTLSNGAVITIEAGKTTGTVTVPAPADDVYKDAGNVQATITNATGGNFENLVTSTTPAVTSVTDTIDTTTVKLTATATAAEGGTVTYTATVGAPVTGSPVIVNLANGQSITIEVGKTTGTVTTIAPNDALTGQAPLTNSITNVSGGNYENLVADKTPVSTTVTDTVDTTNLSLSATGTVAEGGSITYTATLTNAAGSPVTVTLSNGAVITIEAGKTTGTVTVPAPADDVYKDAGNVQATIKSATGGNFENLVTSTTPAVTSVTDTIDTTTVKLTATTTAAEGGTVTYTATVGAPVTGSPVTVNLANGQSITIEVGKTTGTVTTTAPNDALTGHTPLTNSITNVTGGNYENLVADKTPVSTTVTDTIDTTNLSLSATGTVAEGGSITYTATLTNAAGSPVTVTLSNGAVITIDAGKTTGTVTVPAPADDVYKDAGNVQATITNATGGNFENLVTSTTPAVTSVTDTIDTTTVSITGSTSVTEGQTASYTVSLTHPAQTEVTLKIVYSGTAADGSDFTGVYTVKIPAGASSAQFNVATIDDKITEGTENFVVKIDSATGGNFENLAVSSTNGSVSTSIIDNDAPPVIDLDANNSSGATGADYKVTFTEGTTGPGVSIADTDIKITDPDSTMLTGATIVLTNRQDGDALNLGNSVNGITINANSTNGTVTLTLSGNATLADYMQAIKNISFTNSSEDPSTVPRIITVTVTDGGNYSNTATTTVNVVAINDAPVAAPVNVTGTEDTPLILGWSTFGVSDVDSPASSLGVKITQLPGEGKLQYLDGSTWKDVANNQTFSKADIDAGKLRFVPDANESGVNGYGGTGVGNNQADYAQIKFQPTDGQLLGNTGTIKIDITPVADAPTLSVADNSVKSTGLIKEVWTGLSGLGTDGSGANSTTLKNVIDGAGKPNTSGTVNNVQSDGSVTAGTASKTSGLIYLEAGKTYTFSGTGDDSLLVTIGGKSVASTTWGAGGNLNGSFTPTTSGYYTLDIYHHNQSGPGSYDVNLSVNGSTPIDLSSAGVPIYTGVQDLVNAGVTVSDLHGSNGEGYYDGYKLNTGAEGTTVKLSSISTALTDTDGSETLSIKISGAPVGSVLSDGAGHSFTVTATSGDANVTGWNLGTLTVTPPTYYNGQFNLTVTSTSTEQVGGSASTTATIPVTVVPAVYNSIVATSADDTVTGTDGNDIMVADIGGLTVVPGTNYNIAFMVDSSGSMSASSINAAKDSLTSVFNTLKQSLGGSNSGTVNIFLVDFDTQVNKSVSVNLNDPNALTLLKAVLDSMASGGGTNYEDVFKATANFFQSAEAVANTGAKNLTYFITDGQPTYYQSNEQTNPTLYGNVKLDDVVKTSNYKLGSSFATYIDSTHYLSISTSGEVVLQTLKNNNWSWNSLGTIHAQGDGTYEISSLAGSGNSTSSNTTDNSAAGFALLSGLSNVEAIGLNNGVSLNDLKPYDSDKTPQTNIDPKDLANSIIGHTEATMPGNDTVSGGDGNDILFGDLVSFNGIAGEGYQAMQAFVAKETGVDVSKVTTSNVHQYITEHYQAFDVSGAHDGNDTLLGGAGNDILFGSGGNDLLDGGKGNDILLGGTGNDTLIGGQGNDILIGGSGADTFVWKAGDTGNDVIKDFKASEGDRIDLRDLLQGETGSTIDNFLKITTVDGVSSLQVSSGGKFNSGDAAAATPDVTIKLEGNNWSSANIHNLIAGSDPTIKVDHNNS'

	MapA = 'MHMATLIGTVTKVIGQVFAQSADGTRRALVEGDRLFAGDQLITGAEGAVAVHLQNGQELTLGRDSSLTMTGQLLADQAAHVNAPEAVTPSESQLTDVEQIQKAIAAGDDPTKTAEATAAGPGATGGAPGALGGGHSFVLLTEVAGRVDPVIGFPTAGFNGIPEFPEERHNAVIDNGDGQATPIVPPPPPVNNPVTLTGLSVAGGELNLNEANLPDGSAANPGALTQTGSFTVSAPDGLSSLSIGGINVIVGGVPIGFPQSITTQLGNTLTITGYNPATGTVSYSYTLNGNETHAAGDGANNLSEQFTVIAGDSNGDTATGTLDVNITDDVPKAFDDNNGTATETQLTLTGNVLTNDVQGADRVLVGENAGPITAGTFIGTYGTLVLNANGTYTYTLNTNDADFKNLHGGGNGTETFTYTLTDADGDTSTANLVLQIHNNDDPVVINGLNVEGGELTVYEKNLGDGSAPDSGALTQSGTFTITALDGVTTLTIGGIAVVTNGVAAGFPQSIVTPLGSTLTITGFNAATGVVSYSYTLVDNEAHPTANGANVLNEQFAVTVVDDNGTTANATLDVNIVDDLPKGVDDSNAGTASETNLTLSGNVLTNDVQGADRVPVGENAGPITAGTFTGTYGTLVLNANGTYTYTLNTSDADFKALHGGGNGTETFTYTITDADGDTSTANLVLQIHNNDDPVVINGLDVNGGELTVYEKNLSDGTSPNAPALTQSGTFTITALDGVTTLTIGGIAVVTNGVAAGFPQSIVTPLGSTLTITGFNAATGVVSYSYTLVDNEAHPTANGANVLNEQFAVTVVDDNGTTANATLDVNIVDDLPKGVDDSNAGTASETNLTLSGNVLTNDVQGADRVPVGENAGPITAGTFTGTYGTLVLNANGTYTYTLNTSDADFKALHGGGNGTETFTYTITDADGDTSTANLVLQIHNNDDPVIINGLDVNGGELTVYEKNLSDGSSPDAPALTQSGTFTITALDGVTTLTIGGIAVVTNGVAAGFPQSIVTPLGSTLTITGFNAATGVVSYSYTLVDNEAHPTTNGANVLNEQFAVTVVDDNGTTANATLDVNIVDDLPKGVDDSNAGTASETNLTLSGNVLTNDVQGADRVPVGENAGPITAGTFTGTYGTLVLNANGTYTYTLNTSDADFKALHGGGNGTETFTYTITDADGDTSTANLVLQIHNNDDPVVINGLDVNGGELTVYEKNLSDGTSPNAPALTQSGTFTVTALDGLQTLTVGGIAVITNGVAAGFPQSAVTPLGSTLTITGYDPATGVVSYSYTLVDNETHPTANGANSLTENFNVVATDTDGSTATGQINVNIIDDLPTAKPDATSVQEGGTVSGNVLDNDIGGADGPAASGAVVGVRAGSDTSTSAIGGLNSNINGTYGYLTLDANGNAVYHSNPNAVSGPGAVDVFTYTVRDSDGDESTTTITIDVYNSKLCAVSDTDVTVYEKALDLTKDGQDLAPGTVTGSDPTSTGETASGTLVGSVTGAVGAISYALVGSATGNYGQIVLNPDGTYTYTLTSPASTTPHADDGANSLTETFTYQATDSLGNVVTSTIVVNIVDDVPKAINDSNAGTASETQLTLNGNVLTNDVQGADVVAIGPNAGPITPGTFTGTYGTLVLNANGTYTYTLNTNDADFKNLHGGGNGTETFTYTLTDADGDTSTANLVLNIHNNDDPVVLNGLDVYGGELTVYEKNLSDGTSPDTPALTQSGTFTVTALDGLQTLTVGGIAVMTNGVAAGFPQSTVTPLGSTLTITGYNPTTGVVSYSYTLVDNESHPNANGANSITENFNVVATDTDGSTATGQINVNIIDDLPTAKADTGSVAEGGTVNISVLGNDISGADGAAIVVGVRAGGNTATSAIGGLNSNINGNYGYLTLDAAGNAVYHSNPNSVSPPGATDTFTYTIRDSDGDESTTTITVNVADSKLVASTDQDVTVYEKALDLTQDGQDLAPGTVTGSDPGNTGETATGTLVGSVSGGSGAITYTLVGSATGTYGQIQLNADGTYTYTLTSAPKTTPNANDGPNTLSESFTYKATDALGNSTTSTIVVNIVDDVPKAVASERSVAAVEIDSNILIVLDISGSMADASGVPGLSRLELAKQAISALLDKYDDLGDVKVQLVTFSSNATDRTSVWVDVATAKTLLAGLSAGGGTNYDAAVATMYNAFNTSGKLTGAQNVGYFFSDGKPNEGDIGTADEATLKAFLDANNIKNYAIGLGSGVSNANLDPLAYDGITHTNTNAVVVTDLNQLNSVLSGTVEGAPVTGSLIGEGGTFGADGGFIKSIVVDGTTYTYDPKANGGQGSLVASGGANHGTFNTVNNTLSIATNNSGTLVVNLDTGDYSYTSQKTTAVVITENIGFTLSDNDGDLASSTLTVKVIPNAPPVAADDHVITNVLSGNIVVPGELLLANDTDPNGDTLNATPTSFNTGWISKSADFTGSGAISFTGTNANTAANQNLANVRNAFSANAATMTAVLVVSGYLGAVTNTNANDEDRITVNLRQGETLNLDHNLAAGHITMEYSINGGAYIALADGQTLTATSDGVYQIHITNITNTTGSNANAAENYQLTMTLNYAGAHDITPDYHGTYTANDNHGGSDTANVTISYQDGHTLTGTSGDDVLVAGTGDNIINAGDGNDVLTAGSGNNELHGGAGNDLLYSGPGNDLLDGGSGIDTASYAHATAGVTVNLGLLGAQNTIGAGTDTLTGIENLVGSNFNDTLTGDNNNNVINGGLGNDILNGGGGDDLLIGGMGNNTLTGGPGADTFQWLKGNSGHDLVTDFTPGTDKLDLSQLLQGENGTSASLDDYLHFTVTGSGASVMTSIDVSAMAGATPNQTIDLAGVNLASHYGVTPGAGGLIASGHDTATIINGMLNDHSLKVDTV'

	Species_count = {}

	with open(Infile, 'r') as f:
		for line in f.readlines():
			if not "protein.sequence" in line:
				components = line.split(",")
				species = "_".join(components[0].split())
				sequence = components[1]
				if species in Species_count.keys():
					Species_count[species] += 1
				else: 
					Species_count[species] = 1
				LapAoutfilename = "%s/%s%i_LapA.fna" %(Outdir, species, Species_count[species])
				MapAoutfilename = "%s/%s%i_MapA.fna" %(Outdir, species, Species_count[species])
				with open(LapAoutfilename, 'w+') as Lout:
					Lout.write(">%s.%i\n%s\n>LapA\n%s" %(species, Species_count[species], sequence, LapA))
				Lout.close()
				with open(MapAoutfilename, 'w+') as Mout:
					Mout.write(">%s.%i\n%s\n>MapA\n%s" %(species, Species_count[species], sequence, MapA))
				Mout.close()
	f.close()



if __name__ == '__main__':
	main(sys.argv[1], sys.argv[2])